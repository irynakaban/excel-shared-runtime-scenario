{"version":3,"file":"Announced.QuickActions.Example.js","sourceRoot":"../src/","sources":["components/Announced/examples/Announced.QuickActions.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { Announced } from 'office-ui-fabric-react/lib/Announced';\r\nimport {\r\n  DetailsList,\r\n  DetailsListLayoutMode,\r\n  Selection,\r\n  IColumn,\r\n  IDetailsList,\r\n  IDetailsRowProps,\r\n  DetailsRow\r\n} from 'office-ui-fabric-react/lib/DetailsList';\r\nimport { MarqueeSelection } from 'office-ui-fabric-react/lib/MarqueeSelection';\r\nimport { IconButton, PrimaryButton } from 'office-ui-fabric-react/lib/Button';\r\nimport { Dialog, DialogFooter } from 'office-ui-fabric-react/lib/Dialog';\r\nimport { TextField, ITextField } from 'office-ui-fabric-react/lib/TextField';\r\nimport { createRef } from 'office-ui-fabric-react/lib/Utilities';\r\n\r\nconst _items: IAnnouncedQuickActionsExampleItem[] = [];\r\n\r\nconst _columns: IColumn[] = ['Name', 'Modified', 'Modified By', 'File Size'].map((name: string) => {\r\n  const fieldName = name.replace(' ', '').toLowerCase();\r\n  return {\r\n    fieldName,\r\n    name,\r\n    key: fieldName,\r\n    minWidth: 100,\r\n    maxWidth: 200,\r\n    isResizable: true\r\n  };\r\n});\r\n\r\nconst _names: string[] = [\r\n  'Annie Lindqvist',\r\n  'Aaron Reid',\r\n  'Alex Lundberg',\r\n  'Roko Kolar',\r\n  'Christian Bergqvist',\r\n  'Valentina Lovric',\r\n  'Makenzie Sharett'\r\n];\r\n\r\nfunction generateRandomDate(): string {\r\n  return new Date(new Date(2010, 0, 1).getTime() + Math.random() * (new Date().getTime() - new Date(2010, 0, 1).getTime())).toDateString();\r\n}\r\n\r\nexport interface IAnnouncedQuickActionsExampleItem {\r\n  key: number;\r\n  name: string;\r\n  modified: string;\r\n  modifiedby: string;\r\n  filesize: string;\r\n}\r\n\r\nexport interface IAnnouncedQuickActionsExampleState {\r\n  items: IAnnouncedQuickActionsExampleItem[];\r\n  selectionDetails: {};\r\n  renameDialogOpen: boolean;\r\n  dialogContent: JSX.Element | undefined;\r\n  announced?: JSX.Element;\r\n}\r\n\r\nexport class AnnouncedQuickActionsExample extends React.Component<{}, IAnnouncedQuickActionsExampleState> {\r\n  private _selection: Selection;\r\n  private _detailsList = createRef<IDetailsList>();\r\n  private _textField = createRef<ITextField>();\r\n\r\n  constructor(props: {}) {\r\n    super(props);\r\n\r\n    // Populate with items for demos.\r\n    if (_items.length === 0) {\r\n      for (let i = 0; i < 20; i++) {\r\n        _items.push({\r\n          key: i,\r\n          name: 'Item ' + i,\r\n          modified: generateRandomDate(),\r\n          modifiedby: _names[Math.floor(Math.random() * _names.length)],\r\n          filesize: Math.floor(Math.random() * 30).toString() + ' MB'\r\n        });\r\n      }\r\n    }\r\n\r\n    this._selection = new Selection({\r\n      onSelectionChanged: () => this.setState({ selectionDetails: this._getSelectionDetails() })\r\n    });\r\n\r\n    this.state = {\r\n      items: _items,\r\n      selectionDetails: this._getSelectionDetails(),\r\n      renameDialogOpen: false,\r\n      dialogContent: undefined,\r\n      announced: undefined\r\n    };\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const { items, renameDialogOpen, dialogContent } = this.state;\r\n\r\n    return (\r\n      <>\r\n        {this._renderAnnounced()}\r\n        <MarqueeSelection selection={this._selection}>\r\n          <DetailsList\r\n            componentRef={this._detailsList}\r\n            items={items}\r\n            columns={_columns}\r\n            setKey=\"set\"\r\n            layoutMode={DetailsListLayoutMode.fixedColumns}\r\n            selection={this._selection}\r\n            selectionPreservedOnEmptyClick={true}\r\n            ariaLabelForSelectionColumn=\"Toggle selection\"\r\n            ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\r\n            onRenderItemColumn={this._onRenderItemColumn}\r\n            onRenderRow={this._onRenderRow}\r\n          />\r\n          <Dialog hidden={!renameDialogOpen} onDismiss={this._closeRenameDialog} closeButtonAriaLabel=\"Close\">\r\n            {dialogContent}\r\n          </Dialog>\r\n        </MarqueeSelection>\r\n      </>\r\n    );\r\n  }\r\n\r\n  private _onRenderRow = (props: IDetailsRowProps): JSX.Element => {\r\n    return <DetailsRow {...props} />;\r\n  };\r\n\r\n  private _onRenderItemColumn = (item: IAnnouncedQuickActionsExampleItem, index: number, column: IColumn) => {\r\n    const fieldContent = item[column.fieldName as keyof IAnnouncedQuickActionsExampleItem];\r\n\r\n    if (column.key === 'name') {\r\n      return (\r\n        <div>\r\n          {fieldContent}\r\n          <IconButton\r\n            menuIconProps={{ iconName: 'MoreVertical' }}\r\n            role=\"button\"\r\n            aria-haspopup={true}\r\n            aria-label=\"Show actions\"\r\n            styles={{ root: { float: 'right', height: 'inherit' } }}\r\n            menuProps={{\r\n              items: [\r\n                {\r\n                  key: 'delete',\r\n                  text: 'Delete',\r\n                  onClick: () => this._deleteItem(index)\r\n                },\r\n                {\r\n                  key: 'rename',\r\n                  text: 'Rename',\r\n                  onClick: () => this._renameItem(item, index)\r\n                }\r\n              ]\r\n            }}\r\n          />\r\n        </div>\r\n      );\r\n    } else {\r\n      return <span>{fieldContent}</span>;\r\n    }\r\n  };\r\n\r\n  private _renderAnnounced = (): JSX.Element | undefined => {\r\n    const { announced } = this.state;\r\n    return announced;\r\n  };\r\n\r\n  private _deleteItem = (index: number): void => {\r\n    const items = this.state.items;\r\n    items.splice(items.indexOf(items[index]), 1);\r\n\r\n    this.setState({\r\n      items: [...items],\r\n      announced: <Announced message=\"Item deleted\" />\r\n    });\r\n    return;\r\n  };\r\n\r\n  private _renameItem(item: IAnnouncedQuickActionsExampleItem, index: number): void {\r\n    this.setState({\r\n      renameDialogOpen: true,\r\n      dialogContent: (\r\n        <>\r\n          <TextField componentRef={this._textField} label=\"Rename\" value={item.name} />\r\n          <DialogFooter>\r\n            <PrimaryButton onClick={this._updateItemName.bind(this, index)} text=\"Save\" />\r\n          </DialogFooter>\r\n        </>\r\n      )\r\n    });\r\n    return;\r\n  }\r\n\r\n  private _updateItemName(index: number): void {\r\n    if (this._textField && this._textField.current) {\r\n      const items = this.state.items;\r\n      items[index].name = this._textField.current.value || items[index].name;\r\n      this.setState({\r\n        renameDialogOpen: false,\r\n        items: [...items],\r\n        announced: <Announced message=\"Item renamed\" />\r\n      });\r\n    } else {\r\n      return;\r\n    }\r\n  }\r\n\r\n  private _closeRenameDialog = (): void => {\r\n    this.setState({\r\n      renameDialogOpen: false\r\n    });\r\n  };\r\n\r\n  private _getSelectionDetails(): string {\r\n    const selectionCount = this._selection.getSelectedCount();\r\n\r\n    switch (selectionCount) {\r\n      case 0:\r\n        return 'No items selected';\r\n      case 1:\r\n        return '1 item selected: ' + (this._selection.getSelection()[0] as any).name;\r\n      default:\r\n        return `${selectionCount} items selected`;\r\n    }\r\n  }\r\n}\r\n"]}