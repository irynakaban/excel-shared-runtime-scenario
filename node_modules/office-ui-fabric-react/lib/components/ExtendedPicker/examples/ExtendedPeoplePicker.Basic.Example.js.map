{"version":3,"file":"ExtendedPeoplePicker.Basic.Example.js","sourceRoot":"../src/","sources":["components/ExtendedPicker/examples/ExtendedPeoplePicker.Basic.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\n\r\nimport { IPersonaProps } from 'office-ui-fabric-react/lib/Persona';\r\nimport { ExtendedPeoplePicker } from 'office-ui-fabric-react/lib/ExtendedPicker';\r\nimport { PrimaryButton } from 'office-ui-fabric-react/lib/Button';\r\nimport {\r\n  SuggestionsStore,\r\n  FloatingPeoplePicker,\r\n  IBaseFloatingPickerProps,\r\n  IBaseFloatingPickerSuggestionProps\r\n} from 'office-ui-fabric-react/lib/FloatingPicker';\r\nimport { ISelectedPeopleProps, SelectedPeopleList, IExtendedPersonaProps } from 'office-ui-fabric-react/lib/SelectedItemsList';\r\nimport { IFocusZoneProps, FocusZoneTabbableElements } from 'office-ui-fabric-react/lib/FocusZone';\r\nimport { mergeStyleSets, getTheme, IStyle, IProcessedStyleSet } from 'office-ui-fabric-react/lib/Styling';\r\n// Fake data for examples. Not exported by any package.\r\nimport { people, mru, groupOne, groupTwo } from './PeopleExampleData';\r\n\r\nexport interface IPeoplePickerExampleState {\r\n  peopleList: IPersonaProps[];\r\n  mostRecentlyUsed: IPersonaProps[];\r\n  searchMoreAvailable: boolean;\r\n}\r\n\r\ninterface IClassNames {\r\n  picker: IStyle;\r\n  headerItem: IStyle;\r\n  footerItem: IStyle;\r\n  to: IStyle;\r\n}\r\n\r\nexport class ExtendedPeoplePickerBasicExample extends React.Component<{}, IPeoplePickerExampleState> {\r\n  private _picker = React.createRef<ExtendedPeoplePicker>();\r\n  private _floatingPickerProps: IBaseFloatingPickerProps<IPersonaProps>;\r\n  private _selectedItemsListProps: ISelectedPeopleProps;\r\n  private _focusZoneProps: IFocusZoneProps;\r\n  private _suggestionProps: IBaseFloatingPickerSuggestionProps;\r\n  private _classNames: IProcessedStyleSet<IClassNames>;\r\n\r\n  constructor(props: {}) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      peopleList: people,\r\n      mostRecentlyUsed: mru,\r\n      searchMoreAvailable: true\r\n    };\r\n\r\n    this._suggestionProps = {\r\n      showRemoveButtons: true,\r\n      headerItemsProps: [\r\n        {\r\n          renderItem: () => {\r\n            const picker = this._picker.current;\r\n            return (\r\n              <div className={this._classNames.headerItem}>\r\n                Use this address: {picker && picker.inputElement ? picker.inputElement.value : ''}\r\n              </div>\r\n            );\r\n          },\r\n          shouldShow: () => {\r\n            const picker = this._picker.current;\r\n            return !!(picker && picker.inputElement) && picker.inputElement.value.indexOf('@') > -1;\r\n          },\r\n          onExecute: () => {\r\n            const picker = this._picker.current;\r\n            const floatingPicker = picker && picker.floatingPicker.current;\r\n            if (floatingPicker) {\r\n              floatingPicker.forceResolveSuggestion();\r\n            }\r\n          },\r\n          ariaLabel: 'Use the typed address'\r\n        },\r\n        {\r\n          renderItem: () => {\r\n            return <div className={this._classNames.headerItem}>Suggested Contacts</div>;\r\n          },\r\n          shouldShow: this._shouldShowSuggestedContacts\r\n        }\r\n      ],\r\n      footerItemsProps: [\r\n        {\r\n          renderItem: () => {\r\n            return <div className={this._classNames.footerItem}>No results</div>;\r\n          },\r\n          shouldShow: () => {\r\n            const picker = this._picker.current;\r\n            const floatingPicker = picker && picker.floatingPicker.current;\r\n            return !!floatingPicker && floatingPicker.suggestions.length === 0;\r\n          }\r\n        },\r\n        {\r\n          renderItem: () => {\r\n            return <div className={this._classNames.footerItem}>Search for more</div>;\r\n          },\r\n          onExecute: () => {\r\n            this.setState({ searchMoreAvailable: false });\r\n          },\r\n          shouldShow: () => {\r\n            return this.state.searchMoreAvailable && !this._shouldShowSuggestedContacts();\r\n          },\r\n          ariaLabel: 'Search more'\r\n        }\r\n      ],\r\n      shouldSelectFirstItem: () => {\r\n        return !this._shouldShowSuggestedContacts();\r\n      }\r\n    };\r\n\r\n    this._floatingPickerProps = {\r\n      suggestionsStore: new SuggestionsStore<IPersonaProps>(),\r\n      onResolveSuggestions: this._onFilterChanged,\r\n      getTextFromItem: (persona: IPersonaProps) => persona.text || '',\r\n      pickerSuggestionsProps: this._suggestionProps,\r\n      key: 'normal',\r\n      onRemoveSuggestion: this._onRemoveSuggestion,\r\n      onValidateInput: this._validateInput,\r\n      onZeroQuerySuggestion: this._returnMostRecentlyUsed,\r\n      showForceResolve: this._shouldShowForceResolve,\r\n      onInputChanged: this._onInputChanged,\r\n      onSuggestionsHidden: () => {\r\n        console.log('FLOATINGPICKER: hidden');\r\n      },\r\n      onSuggestionsShown: () => {\r\n        console.log('FLOATINGPICKER: shown');\r\n      }\r\n    };\r\n\r\n    this._selectedItemsListProps = {\r\n      onCopyItems: this._onCopyItems,\r\n      onExpandGroup: this._onExpandItem,\r\n      removeMenuItemText: 'Remove',\r\n      copyMenuItemText: 'Copy name',\r\n      editMenuItemText: 'Edit',\r\n      getEditingItemText: this._getEditingItemText,\r\n      onRenderFloatingPicker: FloatingPeoplePicker,\r\n      floatingPickerProps: this._floatingPickerProps\r\n    };\r\n\r\n    this._focusZoneProps = {\r\n      shouldInputLoseFocusOnArrowKey: () => true,\r\n      handleTabKey: FocusZoneTabbableElements.all\r\n    };\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const theme = getTheme();\r\n    this._classNames = mergeStyleSets({\r\n      picker: { maxWidth: 400, marginBottom: 15 },\r\n      headerItem: {\r\n        borderBottom: '1px solid ' + theme.palette.neutralLight,\r\n        padding: '8px 12px'\r\n      },\r\n      footerItem: {\r\n        borderBottom: '1px solid ' + theme.palette.neutralLight,\r\n        height: 60,\r\n        paddingLeft: 12\r\n      },\r\n      to: { padding: '0 10px' }\r\n    });\r\n\r\n    return (\r\n      <div>\r\n        {this._renderExtendedPicker()}\r\n        <PrimaryButton text=\"Set focus\" onClick={this._onSetFocusButtonClicked} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _renderExtendedPicker(): JSX.Element {\r\n    return (\r\n      <ExtendedPeoplePicker\r\n        floatingPickerProps={this._floatingPickerProps}\r\n        selectedItemsListProps={this._selectedItemsListProps}\r\n        onRenderFloatingPicker={FloatingPeoplePicker}\r\n        onRenderSelectedItems={SelectedPeopleList}\r\n        className={this._classNames.picker}\r\n        key=\"normal\"\r\n        inputProps={{\r\n          onBlur: () => console.log('onBlur called'),\r\n          onFocus: () => console.log('onFocus called'),\r\n          'aria-label': 'People Picker'\r\n        }}\r\n        componentRef={this._picker}\r\n        headerComponent={this._renderHeader()}\r\n        focusZoneProps={this._focusZoneProps}\r\n      />\r\n    );\r\n  }\r\n\r\n  private _renderHeader(): JSX.Element {\r\n    return (\r\n      <div className={this._classNames.to} data-is-focusable={true}>\r\n        To:\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private _getEditingItemText = (item: IExtendedPersonaProps): string => {\r\n    return item.text as string;\r\n  };\r\n\r\n  private _onSetFocusButtonClicked = (): void => {\r\n    if (this._picker.current) {\r\n      this._picker.current.focus();\r\n    }\r\n  };\r\n\r\n  private _onExpandItem = (item: IExtendedPersonaProps): void => {\r\n    const picker = this._picker.current;\r\n    const selectedItemsList = picker && picker.selectedItemsList.current;\r\n    if (selectedItemsList) {\r\n      // tslint:disable-next-line:no-any\r\n      (selectedItemsList as SelectedPeopleList).replaceItem(item, this._getExpandedGroupItems(item));\r\n    }\r\n  };\r\n\r\n  private _onRemoveSuggestion = (item: IPersonaProps): void => {\r\n    const { peopleList, mostRecentlyUsed: mruState } = this.state;\r\n    const itemIndex = peopleList.indexOf(item);\r\n    const itemMruIndex = mruState.indexOf(item);\r\n\r\n    const stateUpdate = {} as IPeoplePickerExampleState;\r\n    if (itemIndex >= 0) {\r\n      stateUpdate.peopleList = peopleList.slice(0, itemIndex).concat(peopleList.slice(itemIndex + 1));\r\n    }\r\n    if (itemMruIndex >= 0) {\r\n      stateUpdate.mostRecentlyUsed = mruState.slice(0, itemMruIndex).concat(mruState.slice(itemMruIndex + 1));\r\n    }\r\n    this.setState(stateUpdate);\r\n  };\r\n\r\n  private _onFilterChanged = (filterText: string, currentPersonas?: IPersonaProps[]): Promise<IPersonaProps[]> | null => {\r\n    let filteredPersonas: IPersonaProps[] = [];\r\n    if (filterText) {\r\n      filteredPersonas = this.state.peopleList.filter((item: IPersonaProps) => _startsWith(item.text || '', filterText));\r\n      filteredPersonas = this._removeDuplicates(filteredPersonas, currentPersonas);\r\n    }\r\n\r\n    return this._convertResultsToPromise(filteredPersonas);\r\n  };\r\n\r\n  private _returnMostRecentlyUsed = (): IPersonaProps[] | Promise<IPersonaProps[]> | null => {\r\n    let { mostRecentlyUsed } = this.state;\r\n    const items = (this._picker.current && this._picker.current.items) || [];\r\n    mostRecentlyUsed = this._removeDuplicates(mostRecentlyUsed, items);\r\n    return this._convertResultsToPromise(mostRecentlyUsed);\r\n  };\r\n\r\n  private _onCopyItems(items: IExtendedPersonaProps[]): string {\r\n    return items.map(item => item.text).join(', ');\r\n  }\r\n\r\n  private _shouldShowForceResolve = (): boolean => {\r\n    const picker = this._picker.current;\r\n    const floatingPicker = picker && picker.floatingPicker.current;\r\n    return !!floatingPicker && this._validateInput(floatingPicker.inputText) && floatingPicker.suggestions.length === 0;\r\n  };\r\n\r\n  private _shouldShowSuggestedContacts = (): boolean => {\r\n    const picker = this._picker.current;\r\n    return !!(picker && picker.inputElement) && picker.inputElement.value === '';\r\n  };\r\n\r\n  private _listContainsPersona(persona: IPersonaProps, personas?: IPersonaProps[]): boolean {\r\n    return !!personas && personas.some((item: IPersonaProps) => item.text === persona.text);\r\n  }\r\n\r\n  private _removeDuplicates(personas: IPersonaProps[], possibleDupes?: IPersonaProps[]): IPersonaProps[] {\r\n    return personas.filter((persona: IPersonaProps) => !this._listContainsPersona(persona, possibleDupes));\r\n  }\r\n\r\n  private _onInputChanged = (): void => {\r\n    this.setState({ searchMoreAvailable: true });\r\n  };\r\n\r\n  private _convertResultsToPromise(results: IPersonaProps[]): Promise<IPersonaProps[]> {\r\n    return new Promise<IPersonaProps[]>(resolve => setTimeout(() => resolve(results), 150));\r\n  }\r\n\r\n  private _validateInput = (input: string): boolean => {\r\n    return input.indexOf('@') !== -1;\r\n  };\r\n\r\n  private _getExpandedGroupItems(item: IExtendedPersonaProps): IExtendedPersonaProps[] {\r\n    return item.text === 'Group One' ? groupOne : item.text === 'Group Two' ? groupTwo : [];\r\n  }\r\n}\r\n\r\nfunction _startsWith(text: string, filterText: string): boolean {\r\n  return text.toLowerCase().indexOf(filterText.toLowerCase()) === 0;\r\n}\r\n"]}