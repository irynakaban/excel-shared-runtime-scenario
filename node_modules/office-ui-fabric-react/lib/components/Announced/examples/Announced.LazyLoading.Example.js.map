{"version":3,"file":"Announced.LazyLoading.Example.js","sourceRoot":"../src/","sources":["components/Announced/examples/Announced.LazyLoading.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport { Announced } from 'office-ui-fabric-react/lib/Announced';\r\nimport { createArray, Async } from 'office-ui-fabric-react/lib/Utilities';\r\nimport { Image } from 'office-ui-fabric-react/lib/Image';\r\nimport { FocusZone } from 'office-ui-fabric-react/lib/FocusZone';\r\nimport { Text } from 'office-ui-fabric-react/lib/Text';\r\nimport { Stack, IStackTokens, IStackStyles } from 'office-ui-fabric-react/lib/Stack';\r\nimport { DefaultButton } from 'office-ui-fabric-react/lib/Button';\r\nimport { ProgressIndicator } from 'office-ui-fabric-react/lib/ProgressIndicator';\r\nimport { mergeStyles } from 'office-ui-fabric-react/lib/Styling';\r\n\r\nconst photoStackTokens: IStackTokens = { childrenGap: '6 6' };\r\nconst photoStackStyles: Partial<IStackStyles> = {\r\n  root: {\r\n    border: '1px solid black',\r\n    padding: 10,\r\n    overflowY: 'auto'\r\n  },\r\n  inner: {\r\n    padding: 0\r\n  }\r\n};\r\n\r\nconst photoCellClass = mergeStyles({\r\n  display: 'block',\r\n  boxSizing: 'border-box',\r\n  width: 100,\r\n  height: 100\r\n});\r\n\r\nconst DELAY = 10;\r\nconst PHOTO_COUNT = 30;\r\n\r\ninterface IPhoto {\r\n  url: string;\r\n  width: number;\r\n  height: number;\r\n}\r\n\r\nexport interface IAnnouncedLazyLoadingExampleState {\r\n  /** Number of photos loaded so far */\r\n  total: number;\r\n  announced?: JSX.Element;\r\n  loading: boolean;\r\n  timeSinceLastAnnounce: number;\r\n}\r\n\r\nexport interface IAnnouncedLazyLoadingExampleProps {}\r\n\r\nexport class AnnouncedLazyLoadingExample extends React.Component<IAnnouncedLazyLoadingExampleProps, IAnnouncedLazyLoadingExampleState> {\r\n  private _photos: IPhoto[];\r\n  private _async: Async;\r\n\r\n  constructor(props: {}) {\r\n    super(props);\r\n\r\n    this._async = new Async(this);\r\n    this._photos = this._createPhotos();\r\n\r\n    this.state = {\r\n      total: 0,\r\n      announced: undefined,\r\n      loading: false,\r\n      timeSinceLastAnnounce: 0\r\n    };\r\n  }\r\n\r\n  public componentDidMount() {\r\n    const interval1 = this._async.setInterval(() => {\r\n      const { loading, total } = this.state;\r\n      if (loading && total < PHOTO_COUNT) {\r\n        this.setState({ total: total + 1 });\r\n      } else if (total === PHOTO_COUNT) {\r\n        this.setState({ announced: undefined });\r\n        this._async.clearInterval(interval1);\r\n      }\r\n    }, 2000);\r\n\r\n    const interval2 = this._async.setInterval(() => {\r\n      const { loading, total, timeSinceLastAnnounce } = this.state;\r\n      if (loading) {\r\n        this.setState({ timeSinceLastAnnounce: timeSinceLastAnnounce + 1 });\r\n\r\n        if (timeSinceLastAnnounce === DELAY || total === PHOTO_COUNT) {\r\n          this.setState({\r\n            announced: <Announced message={`${total} of ${PHOTO_COUNT} photos loaded`} />,\r\n            timeSinceLastAnnounce: 0\r\n          });\r\n\r\n          if (total === PHOTO_COUNT) {\r\n            this._async.clearInterval(interval2);\r\n          }\r\n        }\r\n      }\r\n    }, 1000);\r\n  }\r\n\r\n  public render(): JSX.Element {\r\n    const { announced, total, loading } = this.state;\r\n    const stackTokens: IStackTokens = { childrenGap: 10 };\r\n    const percentComplete = total / PHOTO_COUNT;\r\n\r\n    return (\r\n      <Stack tokens={stackTokens}>\r\n        <Text>\r\n          Turn on Narrator and press the button to start loading photos. Announced should announce the number of photos loaded every 10\r\n          seconds, as that is the delay chosen for this example.\r\n        </Text>\r\n        <DefaultButton\r\n          text={loading ? 'Pause loading' : 'Load photos'}\r\n          onClick={loading ? this._pauseLoading : this._startLoading}\r\n          styles={{ root: { width: 150 } }}\r\n        />\r\n        <ProgressIndicator label={percentComplete < 1 ? 'Loading photos' : 'Finished loading photos'} percentComplete={percentComplete} />\r\n        {announced}\r\n        <FocusZone>\r\n          <Stack\r\n            horizontal\r\n            wrap\r\n            // Render the inner content as a ul (there's not currently a less-verbose way to do this)\r\n            // tslint:disable-next-line:jsx-no-lambda\r\n            inner={render => render((_, props) => <ul className={props.className}>{props.children}</ul>)}\r\n            tokens={photoStackTokens}\r\n            styles={photoStackStyles}\r\n          >\r\n            {this._renderPhotos()}\r\n          </Stack>\r\n        </FocusZone>\r\n      </Stack>\r\n    );\r\n  }\r\n\r\n  public componentWillUnmount(): void {\r\n    this._async.dispose();\r\n  }\r\n\r\n  private _startLoading = () => {\r\n    this.setState({ loading: true });\r\n  };\r\n\r\n  private _pauseLoading = () => {\r\n    this.setState({ loading: false });\r\n  };\r\n\r\n  private _createPhotos(): IPhoto[] {\r\n    const width = 100;\r\n    const height = 100;\r\n\r\n    const result = createArray(PHOTO_COUNT, () => {\r\n      return {\r\n        url: `http://placehold.it/${width}x${height}`,\r\n        width: width,\r\n        height: height\r\n      };\r\n    });\r\n    return result;\r\n  }\r\n\r\n  private _renderPhotos(): JSX.Element[] {\r\n    const result = this._photos.map((photo: IPhoto, index: number) => (\r\n      <li\r\n        key={index}\r\n        className={photoCellClass}\r\n        aria-posinset={index + 1}\r\n        aria-setsize={PHOTO_COUNT}\r\n        aria-label=\"Photo\"\r\n        data-is-focusable={true}\r\n      >\r\n        {this.state.total > index ? <Image src={photo.url} width={photo.width} height={photo.height} /> : <div />}\r\n      </li>\r\n    ));\r\n\r\n    return result;\r\n  }\r\n}\r\n"]}